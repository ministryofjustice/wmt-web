{% extends "includes/layout.html" %}

{% block content %}

<main id="content" role="main">

{% include "includes/breadcrumbs.html" %}

{% include "includes/validation-error-messages.html" %}

{% include "includes/title-subtitle.html" %}

{% include "includes/sub-nav.html" %}

{% if organisationLevel === 'team'%}
<h2 class="heading-large">Caseload totals</h2>

<div id="caseloadSummary" class="grid-row">
  <div class="column-one-third">
    <div id="custodyTotal" class="data">
      <span class="data-item bold-xlarge">{{ custodyTotalSummary }}</span>
      <span class="data-item bold-xsmall">Custody cases</span>
    </div>
  </div>
  <div class="column-one-third">
    <div id="communityTotal" class="data">
      <span class="data-item bold-xlarge">{{ communityTotalSummary }}</span>
      <span class="data-item bold-xsmall">Community cases</span>
    </div>
  </div>
  <div class="column-one-third">
    <div id="licenseTotal" class="data">
      <span class="data-item bold-xlarge">{{ licenseTotalSummary }}</span>
      <span class="data-item bold-xsmall">License cases</span>
    </div>
  </div>
</div>

<h2 class="heading-large">Caseload type breakdown</h2>
<div class="js-tabs">
  <ul class="js-tabs-links">
    {% for caseType in caseTypes %}
	    <li><a href="#{{caseType.displayName}}" role="dynamic">{{caseType.displayName | title}}</a></li>
    {% endfor %}
  </ul>
  
  <div class="js-tabs-content">
  {% for caseType in caseTypes %}
    <div id="{{caseType.displayName}}">
      <h3 class="heading-medium">{{ caseType.displayName | title }} caseload by tier</h3>

      <table class="sln-table-caseload data-table">
        <thead>
          <tr>
            <th colspan="2" id="{{caseType.displayName}}_om">Offender manager</th>
            <th colspan="9" id="{{caseType.displayName}}_tiers">Case tiers</th>
          </tr>
          <tr>
            <th id="{{caseType.displayName}}_name">Name</th>
            <th id="{{caseType.displayName}}_grade">Grade</th>
            <th id="{{caseType.displayName}}_untiered">Untiered</th>
            <th id="{{caseType.displayName}}_d2">D2</th>
            <th id="{{caseType.displayName}}_d1">D1</th>
            <th id="{{caseType.displayName}}_c2">C2</th>
            <th id="{{caseType.displayName}}_c1">C1</th>
            <th id="{{caseType.displayName}}_b2">B2</th>
            <th id="{{caseType.displayName}}_b1">B1</th>
            <th id="{{caseType.displayName}}_a">A</th>
            <th id="{{caseType.displayName}}_total">Total</th>
          </tr>
        </thead>

        <tbody class="">
          {% for member in caseType.array %}
            <tr>
              <td headers="{{caseType.displayName}}_om {{caseType.displayName}}_name"><a href="/offender-manager/{{ member.linkId }}">{{ member.name }}</a></td>
              <td headers="{{caseType.displayName}}_om {{caseType.displayName}}_grade">{{ member.gradeCode }}</td>
              <td headers="{{caseType.displayName}}_tiers {{caseType.displayName}}_untiered">{{ member.untiered }}</td>
              <td headers="{{caseType.displayName}}_tiers {{caseType.displayName}}_d2">{{ member.d2 }}</td>
              <td headers="{{caseType.displayName}}_tiers {{caseType.displayName}}_d1">{{ member.d1 }}</td>
              <td headers="{{caseType.displayName}}_tiers {{caseType.displayName}}_c2">{{ member.c2 }}</td>
              <td headers="{{caseType.displayName}}_tiers {{caseType.displayName}}_c1">{{ member.c1 }}</td>
              <td headers="{{caseType.displayName}}_tiers {{caseType.displayName}}_b2">{{ member.b2 }}</td>
              <td headers="{{caseType.displayName}}_tiers {{caseType.displayName}}_b1">{{ member.b1 }}</td>
              <td headers="{{caseType.displayName}}_tiers {{caseType.displayName}}_a">{{ member.a }}</td>
              <td headers="{{caseType.displayName}}_tiers {{caseType.displayName}}_total">{{ member.totalCases }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

  {% endfor %}

  </div>
</div>
{% elseif organisationLevel === 'ldu'%}

<h3 class="heading-medium">Caseload by grade</h3>
  <table class="sln-table-caseload data-table">
    <thead>
      <tr>
        <th colspan="2" id="team">Team</th>
        <th colspan="9" id="tiers">Cases by tier</th>
      </tr>
      <tr>
        <th id="name">Name</th>
        <th id="grade">Grade</th>
        <th id="overall">Overall</th>
        <th id="untiered">Untiered</th>
        <th id="d2">D2</th>
        <th id="d1">D1</th>
        <th id="c2">C2</th>
        <th id="c1">C1</th>
        <th id="b2">B2</th>
        <th id="b1">B1</th>
        <th id="a">A</th>
      </tr>
    </thead>
    <tbody class="">
      {% for team in lduCaseloadDetails %}
        {% for i in range(0, team.grades.length) %}
        <tr>
          {% if i === 0 %}
          <td rowspan="2" headers="name team"><a href="/team/{{ team.linkId }}">{{ team.name }}</a></td>
          {% endif %}
          <td headers="grade team">{{ team.grades[i].gradeCode }}</td>
          <td headers="overall tiers">{{ team.grades[i].totalCases }}%</td>
          <td headers="untiered tiers">{{ team.grades[i].untiered }}%</td>
          <td headers="d2 tiers">{{ team.grades[i].d2 }}%</td>
          <td headers="d1 tiers">{{ team.grades[i].d1 }}%</td>
          <td headers="c2 tiers">{{ team.grades[i].c2 }}%</td>
          <td headers="c1 tiers">{{ team.grades[i].c1 }}%</td>
          <td headers="b2 tiers">{{ team.grades[i].b2 }}%</td>
          <td headers="b1 tiers">{{ team.grades[i].b1 }}%</td>
          <td headers="a tiers">{{ team.grades[i].a }}%</td>
        </tr>
        {% endfor %}
      {% endfor %}
    </tbody>
  </table>

{% endif %}

</main>
{% endblock %}

{% block body_end %}
  <script src="/public/javascripts/vendor/jquery.js"></script>
  <script src="/public/javascripts/jquery.tabs.js"></script>

  <script>
    $(function(){
      $('.js-tabs').tabs();
    });
  </script>
{% endblock %}