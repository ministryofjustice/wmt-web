{% extends "includes/layout.html" %} 

{% block content %}

<main id="content" role="main">

{% include "includes/breadcrumbs.html" %}
 
{% include "includes/title-subtitle.html" %}

{% include "includes/validation-error-messages.html" %}

<form method="post" class "archive-form">
        {% include "includes/csrf-hidden-input.html"%}
        
        <div class="govuk-form-group {% if errors['archiveFromDate'][0] %} govuk-form-group--error {% endif %}" id="from">
            {% if errors %}
                <span id="archive-from-error" class="govuk-error-message">
                    <span class="govuk-visually-hidden">Error:</span> {{ errors['archiveFromDate'][0] }}
                </span>
            {% endif %}
            <fieldset class="govuk-fieldset" role="group" aria-describedby="fortnightly-archive-from-hint" id="archiveFromDate">
                <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
                    <h1 class="govuk-fieldset__heading">
                        Show archive data from:
                    </h1>
                </legend>
                <div class="govuk-hint" id="fortnightly-archive-from-hint">For example, 30 1 2015 - This date must be on or after 18/06/2014</div>
                <div class="govuk-date-input">
                    <div class="govuk-date-input__item">
                        <div class="govuk-form-group">
                            <label class="govuk-label govuk-date-input__label" for="fortnightly-archive-from-day">Day</label>
                            <input class="govuk-input govuk-date-input__input govuk-input--width-2 {% if errors['archiveFromDate'][0] %} govuk-input--error {% endif %}" id="fortnightly-archive-from-day" name="fortnightly-archive-from-day" 
                            value={{dateRange.fromFields[0] | int}}>
                        </div>
                    </div>
                     <div class="govuk-date-input__item">
                        <div class="govuk-form-group">
                            <label class="govuk-label govuk-date-input__label" for="fortnightly-archive-from-month">Month</label>
                            <input class="govuk-input govuk-date-input__input govuk-input--width-2 {% if errors['archiveFromDate'][0] %} govuk-input--error {% endif %}" id="fortnightly-archive-from-month" name="fortnightly-archive-from-month" 
                                value={{dateRange.fromFields[1] | int}}>
                        </div>
                    </div>
                    <div class="govuk-date-input__item">
                        <div class="govuk-form-group">
                            <label class="govuk-label govuk-date-input__label" for="fortnightly-archive-from-year">Year</label>
                            <input class="govuk-input govuk-date-input__input govuk-input--width-4 {% if errors['archiveFromDate'][0] %} govuk-input--error {% endif %}" id="fortnightly-archive-from-year" name="fortnightly-archive-from-year" 
                            value={{dateRange.fromFields[2] | int}}>
                        </div>        
                    </div>
                </div>
            </fieldset>
        </div>

        <div class="govuk-form-group {% if errors['archiveToDate'][0] %} govuk-form-group--error {% endif %}" id="to">
            {% if errors %}
                <span id="archive-to-error" class="govuk-error-message">
                    <span class="govuk-visually-hidden">Error:</span> {{ errors['archiveToDate'][0] }}
                </span>
            {% endif %}
            <fieldset class="govuk-fieldset" role="group" aria-describedby="fortnightly-archive-to-hint" id="archiveToDate">
                <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
                    <h1 class="govuk-fieldset__heading">
                        Show archive data to:
                    </h1>
                </legend>
                <div class="govuk-hint" id="fortnightly-archive-to-hint">For example, 31 3 2015 - Must be between 19/06/2014 and 25/08/2016</div>
                <div class="govuk-date-input">
                    <div class="govuk-date-input__item">
                        <div class="govuk-form-group">
                            <label class="govuk-label govuk-date-input__label" for="fortnightly-archive-to-day">Day</label>
                            <input class="govuk-input govuk-date-input__input govuk-input--width-2 {% if errors['archiveToDate'][0] %} govuk-input--error {% endif %}" id="fortnightly-archive-to-day" name="fortnightly-archive-to-day" 
                                value={{dateRange.toFields[0] | int}}>
                        </div>
                        
                     </div>
                     <div class="govuk-date-input__item">
                        <div class="govuk-form-group">
                            <label class="govuk-label govuk-date-input__label" for="fortnightly-archive-to-month">Month</label>
                            <input class="govuk-input govuk-date-input__input govuk-input--width-2 {% if errors['archiveToDate'][0] %} govuk-input--error {% endif %}" id="fortnightly-archive-to-month" name="fortnightly-archive-to-month" 
                                value={{dateRange.toFields[1] | int}}>
                        </div>
                    </div>
                    <div class="govuk-date-input__item">
                        <div class="govuk-form-group">
                            <label class="govuk-label govuk-date-input__label" for="fortnightly-archive-to-year">Year</label>
                            <input class="govuk-input govuk-date-input__input govuk-input--width-4 {% if errors['archiveToDate'][0] %} govuk-input--error {% endif %}" id="fortnightly-archive-to-year" name="fortnightly-archive-to-year" 
                            value={{dateRange.toFields[2] | int}}>
                        </div>        
                    </div>
                </div>
            </fieldset>
        </div>

        <div class="govuk-form-group" id="fortnightly-multi-search-field">
            <fieldset class="govuk-fieldset" role="group" aria-describedby="fortnightlys-multi-search-field-hint" id="multiSearchDate">
                <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
                    <h1 class="govuk-fieldset__heading">
                        Search by Offender Manager, Team or Probation Delivery Unit
                    </h1>
                </legend>
                <div class="govuk-hint" id="fortnightly-multi-search-field-hint">For Example, John Smith</div>
                <div aria-describedby="fortnightly-multi-search-field-hint">
                    <div class="form-group">
                        <label class="govuk-label govuk-date-input__label" for="fortnightly-multi-search-field-entry">Extra Search Criteria</label>
                        <input class="govuk-input" id="fortnightly-multi-search-field-entry" name="fortnightly-multi-search-field-entry" value="{{ extraSearchCriteria | safe }}">
                    </div>
                </div>
            </fieldset>
        </div>
        
        <div class="grid-row form-group">
            <fieldset class="column-full inline">
              <legend>
                <span class="form-label-bold">
                  How would you like this data grouped?
                </span>
              </legend>
          
              <div class="column-one-quarter multiple-choice">
                <input id="radio-inline-1" type="radio" name="radio-inline-group-2" value="Yes" checked>
                <label for="radio-inline-1">Offender Manager</label>
              </div>
              <div class="column-one-quarter multiple-choice">
                <input id="radio-inline-2" type="radio" name="radio-inline-group-2" value="No">
                <label for="radio-inline-2">Team</label>
              </div>
          
            </fieldset>
          </div>

          <div class="grid-row form-group">
            <fieldset class="column-full inline">
              <legend>
                <span class="form-label-bold">
                  At what intervals would you like this data grouped?
                </span>
              </legend>
          
              <div class="column-one-quarter multiple-choice">
                <input id="radio-inline-1" type="radio" name="radio-inline-group" value="Yes" checked>
                <label for="radio-inline-1">Weekly</label>
              </div>
              <div class="column-one-quarter multiple-choice">
                <input id="radio-inline-2" type="radio" name="radio-inline-group" value="No">
                <label for="radio-inline-2">Monthly</label>
              </div>
          
            </fieldset>
          </div>

        <input id="archive-fortnightly-filter-submit" type="submit" value="Search" class="govuk-button" data-module="govuk-button" formaction="/archive-data/average-caseload-data">
        <input id="archive-fortnightly-csv-submit" type="submit" class="govuk-button sln-export floatRightBottom10 marginLeft10" value="Export Archive Data" formaction="/archive-data/average-caseload-data/archive-csv" data-module="govuk-button">
</form>
<br/>

{% if (results) %}
<table id="fortnightly-caseload-table" class="govuk-table js-data-table data-table dataTable width100Percent" cellspacing="0" width="100%" role="grid" aria-describedby="example_info">
    <thead>
        <tr class="headers">
            <th id="workloadID">Start Date</th>
            <th id="workloadDate">End Date</th>
            <th id="cluster">Cluster</th>
            <th id="team">Team</th>
            <th id="offenderManager">Offender Manager</th>
            <th id="totalCases">Average Cases</th>
            <th id="capacity">Average Capacity %</th>
            <th id="reductions">Average Reductions</th>
        </tr>
    </thead>
    <tbody>
      {% for result in results %}
        <tr>
            <td>{{ result.startDate }}</td>
            <td>{{ result.endDate }}</td>
            <td>{{ result.lduName }}</td>
            <td>{{ result.teamName }}</td>
            <td>{{ result.omName }}</td>
            <td>{{ result.totalCases }}</td>
            <td>{{ result.capacity }}</td>
            <td>{{ result.hoursReduction }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endif %}
<br/>
</main>

<script src="{{ assetPath }}javascripts/vendor/jquery.min.js"></script>
<script src="{{ assetPath }}javascripts/datatables.min.js"></script>
<script src="{{ assetPath }}javascripts/archive-data-fortnightly.js"></script>

{% endblock %}